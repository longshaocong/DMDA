Traceback (most recent call last):

Error in atexit._run_exitfuncs:
Traceback (most recent call last):

Exception ignored in: Exception ignored in sys.unraisablehook======Traceback (most recent call last):

Error in atexit._run_exitfuncs:
Traceback (most recent call last):

Exception ignored in: Exception ignored in sys.unraisablehook======Traceback (most recent call last):

Error in atexit._run_exitfuncs:
Traceback (most recent call last):

Exception ignored in: Exception ignored in sys.unraisablehook======Traceback (most recent call last):

Error in atexit._run_exitfuncs:
Traceback (most recent call last):

Exception ignored in: Exception ignored in sys.unraisablehook======Traceback (most recent call last):

Error in atexit._run_exitfuncs:
Traceback (most recent call last):

Exception ignored in: Exception ignored in sys.unraisablehook======
======
Traceback (most recent call last):
  File "train.py", line 62, in <module>
    loss_list = alg_loss_dict(args)
  File "D:\Reseach\2022spring\code\CODG\utils\util.py", line 24, in alg_loss_dict
    return loss_dict[args.algorithm]
KeyError: 'DANN'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 27, in get_img_dataloader
    tmpdatay = ImageDataset(args.dataset, args.task, args.data_dir, 
AttributeError: 'Namespace' object has no attribute 'task'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 28, in get_img_dataloader
    name[i], i, transform=imgutil.image_train(args.dataset), test_envs=args.test_envs).lables
TypeError: 'builtin_function_or_method' object is not subscriptable
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 28, in get_img_dataloader
    name[i], i, transform=imgutil.image_train(args.dataset), test_envs=args.test_envs).labels
TypeError: 'builtin_function_or_method' object is not subscriptable
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 20, in get_img_dataloader
    if i in args.test_envs:
TypeError: argument of type 'int' is not iterable
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 21, in get_img_dataloader
    tedatalist.append(ImageDataset(args.dataset, args.data_dir,
  File "D:\Reseach\2022spring\code\CODG\datautil\imgdata\imgdataload.py", line 23, in __init__
    self.indices = np.arrage(len(imgs))
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\numpy\__init__.py", line 313, in __getattr__
    raise AttributeError("module {!r} has no attribute "
AttributeError: module 'numpy' has no attribute 'arrage'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 25, in get_img_dataloader
    name[i], i, transform=imgutil.image_train(args.dataset), test_envs=args.test_envs).labels
NameError: name 'name' is not defined
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 25, in get_img_dataloader
    names[i], i, transform=imgutil.image_train(args.dataset), test_envs=args.test_envs).labels
  File "D:\Reseach\2022spring\code\CODG\datautil\imgdata\util.py", line 21, in image_train
    transforms.RandomResizeCrop(224, scale=(0.7, 1.0)), 
AttributeError: module 'torchvision.transforms' has no attribute 'RandomResizeCrop'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 37, in get_img_dataloader
    trdatalist.append(ImageDataset(args.dataset, args.task, args.data_dir, 
AttributeError: 'Namespace' object has no attribute 'task'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 39, in get_img_dataloader
    tedatalist.append(ImageDataset(args.dastaset, args.root_dir, 
AttributeError: 'Namespace' object has no attribute 'dastaset'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 39, in get_img_dataloader
    tedatalist.append(ImageDataset(args.dataset, args.root_dir, 
AttributeError: 'Namespace' object has no attribute 'root_dir'
======
======
======
Traceback (most recent call last):
  File "train.py", line 64, in <module>
    train_loader, eval_loader = get_img_dataloader(args)
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 42, in get_img_dataloader
    train_loader = [InfiniteDataLoader(
  File "D:\Reseach\2022spring\code\CODG\datautil\getdataloader.py", line 42, in <listcomp>
    train_loader = [InfiniteDataLoader(
TypeError: __init__() got an unexpected keyword argument 'drop_last'
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 15, in __init__
    super(JDM, self).__init__(args)
TypeError: object.__init__() takes exactly one argument (the instance to initialize)
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 15, in __init__
    super(JDM, self).__init__(args)
TypeError: object.__init__() takes exactly one argument (the instance to initialize)
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 17, in __init__
    self.featurizer = get_fea(args)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 41, in get_fea
    net = RES(args.net)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 16, in __init__
    self.conv1 = model.conv1
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1159, in __setattr__
    raise AttributeError(
AttributeError: cannot assign module before Module.__init__() call
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 17, in __init__
    self.featurizer = get_fea(args)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 41, in get_fea
    net = RES(args.net)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 16, in __init__
    self.conv1 = model.conv1
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1159, in __setattr__
    raise AttributeError(
AttributeError: cannot assign module before Module.__init__() call
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 17, in __init__
    self.featurizer = get_fea(args)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 41, in get_fea
    net = RES(args.net)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 16, in __init__
    self.conv1 = model.conv1
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1159, in __setattr__
    raise AttributeError(
AttributeError: cannot assign module before Module.__init__() call
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 18, in __init__
    self.classifier = feat_classifier(args.num_classes, self.featurizer.in_features)
  File "D:\Reseach\2022spring\code\CODG\JDM\common_network.py", line 13, in __init__
    self.fc = nn.Linear(feat_dim, classes)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1159, in __setattr__
    raise AttributeError(
AttributeError: cannot assign module before Module.__init__() call
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 19, in __init__
    self.discriminator = adver_network.Discriminator(
  File "D:\Reseach\2022spring\code\CODG\JDM\adver_network.py", line 23, in __init__
    self.layers = nn.Sequential(
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1159, in __setattr__
    raise AttributeError(
AttributeError: cannot assign module before Module.__init__() call
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 69, in <module>
    opt = optimizer(model, args)
  File "D:\Reseach\2022spring\code\CODG\JDM\opt.py", line 24, in optimizer
    params = get_params(model, args)
  File "D:\Reseach\2022spring\code\CODG\JDM\opt.py", line 15, in get_params
    {'params': model.featurizer.parameters(), 'lr': agrs.lr_decay1 * initlr}, 
NameError: name 'agrs' is not defined
======
======
======
======
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:64
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
Traceback (most recent call last):
  File "train.py", line 84, in <module>
    step_vals = model.update(minibatches, opt, sch)
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 27, in update
    z = self.featurizer(x)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\Reseach\2022spring\code\CODG\JDM\RESNET.py", line 32, in forward
    x = self.layer1(x)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\container.py", line 139, in forward
    input = module(input)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torchvision\models\resnet.py", line 74, in forward
    out = self.conv2(out)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\conv.py", line 443, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\conv.py", line 439, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 148.00 MiB (GPU 0; 6.00 GiB total capacity; 2.02 GiB already allocated; 2.55 GiB free; 2.04 GiB reserved in total by PyTorch)
======
======
======
======
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
Traceback (most recent call last):
  File "train.py", line 84, in <module>
    step_vals = model.update(minibatches, opt, sch)
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 38, in update
    disc_input = adver_network.ReverseLayer.apply(
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\autograd\function.py", line 170, in forward
    raise NotImplementedError("You must implement the forward function for custom"
NotImplementedError: You must implement the forward function for custom autograd.Function.
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
AttributeError: 'JDM' object has no attribute 'cuda'
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 15, in __init__
    super(JDM. self).__init__()
AttributeError: type object 'JDM' has no attribute 'self'
======
======
======
======
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
Traceback (most recent call last):
  File "train.py", line 84, in <module>
    step_vals = model.update(minibatches, opt, sch)
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 38, in update
    disc_input = adver_network.ReverseLayer.apply(
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\autograd\function.py", line 170, in forward
    raise NotImplementedError("You must implement the forward function for custom"
NotImplementedError: You must implement the forward function for custom autograd.Function.
======
======
======
======
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
Traceback (most recent call last):
  File "train.py", line 84, in <module>
    step_vals = model.update(minibatches, opt, sch)
  File "D:\Reseach\2022spring\code\CODG\JDM\JDM.py", line 50, in update
    loss.backward()
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\autograd\__init__.py", line 147, in backward
    Variable._execution_engine.run_backward(
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\autograd\function.py", line 87, in apply
    return self._forward_cls.backward(self, *args)  # type: ignore[attr-defined]
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\autograd\function.py", line 195, in backward
    raise NotImplementedError("You must implement the backward function for custom"
NotImplementedError: You must implement the backward function for custom autograd.Function.
======
======
======
======
Traceback (most recent call last):
  File "train.py", line 67, in <module>
    model = JDM(args).cuda()
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 637, in cuda
    return self._apply(lambda t: t.cuda(device))
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 530, in _apply
    module._apply(fn)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 530, in _apply
    module._apply(fn)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 552, in _apply
    param_applied = fn(param)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 637, in <lambda>
    return self._apply(lambda t: t.cuda(device))
RuntimeError: CUDA error: unknown error
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Traceback (most recent call last):
  File "train.py", line 63, in <module>
    model = JDM(args).cuda()
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 637, in cuda
    return self._apply(lambda t: t.cuda(device))
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 530, in _apply
    module._apply(fn)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 530, in _apply
    module._apply(fn)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 552, in _apply
    param_applied = fn(param)
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\modules\module.py", line 637, in <lambda>
    return self._apply(lambda t: t.cuda(device))
RuntimeError: CUDA error: unknown error
==========
==========
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
=================epoch 0==============
Traceback (most recent call last):
  File "train.py", line 92, in <module>
    s += (item + '_loss:%.4f, '%(step_vals[item]))
KeyError: 'dis'
==========
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
=================epoch 0==============
class_loss:0.5137, dis_loss:0.9245, total_loss:1.4382,
Traceback (most recent call last):
  File "train.py", line 96, in <module>
    acc_record[item] = np.mean(np.array(
  File "<__array_function__ internals>", line 5, in mean
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\numpy\core\fromnumeric.py", line 3440, in mean
    return _methods._mean(a, axis=axis, dtype=dtype,
  File "C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\numpy\core\_methods.py", line 191, in _mean
    ret = ret / rcount
TypeError: unsupported operand type(s) for /: 'generator' and 'int'
==========
=================heper-parameter used========
==========================================
net:resnet18
num_classes:7
dis_hidden:256
test_envs:[0]
data_file:
dataset:PACS
data_dir:../DG_via_Joint/transferlearning/data/PACS/
split_style:strat
batch_size:32
N_WORKERS:4
seed:3407
algorithm:JDM
domain_num:4
lr:0.001
lr_decay:0.75
lr_decay1:1.0
lr_decay2:1.0
schuse:False
schusech:cos
weight_decay:0.0005
momentum:0.9
max_epoch:100
steps_per_epoch:100
lr_gamma:0.0003
checkpoint_frep:1
save_model_every_checkpoint:False
output:./train_output/0505/art_painting
temperature:0.07
alpha:0.5
domains:['art_painting', 'cartoon', 'photo', 'sketch']
img_dataset:{'PACS': ['art_painting', 'cartoon', 'photo', 'sketch']}
input_shape:(3, 224, 224)

====================start training==============
C:\ProgramData\Anaconda3\envs\pytorch1_90\lib\site-packages\torch\nn\functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  ..\c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
=================epoch 0==============
class_loss:0.5137, dis_loss:0.9245, total_loss:1.4382,
